<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á ‚ú®</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* --- ‡πÇ‡∏ó‡∏ô‡∏Ç‡∏≤‡∏ß‡∏î‡∏≥ --- */
    body {
      background: linear-gradient(to bottom right, #111111, #333333);
      color: #eeeeee;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 24px;
      font-family: 'Arial', sans-serif;
      animation: fadeIn 1s ease;
    }

    .goal-item {
      background: #1c1c1c;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
      padding: 20px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .goal-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(255, 255, 255, 0.15);
    }

    .goal-image-container {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      margin-right: 16px;
      background: #444;
      animation: popIn 0.6s ease;
    }
    .goal-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .add-new-goal-btn {
      width: 100%;
      background: #444;
      color: #fff;
      padding: 12px;
      border-radius: 10px;
      font-weight: bold;
      margin-bottom: 16px;
      transition: background 0.3s ease;
    }
    .add-new-goal-btn:hover {
      background: #666;
    }

    .popup, .goal-details-popup {
  background: #222; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
  color: #eee; /* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
  border-radius: 12px; /* ‡∏Ç‡∏≠‡∏ö‡πÇ‡∏Ñ‡πâ‡∏á */
  padding: 100px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô */
  box-shadow: 0 6px 20px rgba(255, 255, 255, 0.2); /* ‡πÄ‡∏á‡∏≤ */
  display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
  position: fixed; /* ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
  top: 50%; /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
  left: 50%; /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ */
  transform: translate(-50%, -50%) scale(0.95); /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î */
  z-index: 20; /* ‡∏à‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• */
  animation: popIn 0.5s ease forwards; /* ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô */
}

    .popup label, .goal-details-popup label {
      color: #ccc;
    }
    .popup input, .goal-details-popup input {
      background: #333;
      border: 1px solid #555;
      color: #eee;
    }

    .popup button, .goal-details-popup button {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s ease;
    }
    .popup button.confirm {
      background: #4CAF50;
      color: #fff;
    }
    .popup button.cancel, .goal-details-popup button {
      background: #f44336;
      color: #fff;
    }
    .popup button:hover, .goal-details-popup button:hover {
      opacity: 0.8;
    }

    .goal-actions button {
      background: #555;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 0.9rem;
      margin-left: 8px;
      transition: background 0.3s ease;
    }
    .goal-actions button:hover {
      background: #777;
    }

    .progress-ring-large svg {
      transform: rotate(-90deg);
    }
    .progress-ring-large circle:first-child {
      stroke: #555;
    }
    .progress-ring-large circle:last-child {
      stroke: #eee;
    }
    #details-progress-percent {
      fill: #eee;
    }

    a {
      color: #aaa;
      text-decoration: underline;
      transition: color 0.3s;
    }
    a:hover {
      color: #fff;
    }

    h1, h2 {
      color: #fff;
      margin-bottom: 16px;
    }

    /* --- ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡πà‡∏ô --- */
    @keyframes fadeIn {
      0% { opacity: 0; transform: scale(0.95); }
      100% { opacity: 1; transform: scale(1); }
    }

    @keyframes popIn {
      0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
      100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
  </style>
</head>

<body>

<div class="max-w-md w-full">
  <h1 class="text-3xl font-bold text-center mb-8">üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</h1>

  <button onclick="showAddGoalPopup()" class="add-new-goal-btn">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà</button>

  <div id="goals-list"></div>
</div>

<div id="add-goal-popup" class="popup">
  <h2 class="text-xl font-bold mb-4">‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà</h2>
  <div>
    <label for="new-target-name">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
    <input type="text" id="new-target-name" class="w-full p-2 mb-3 rounded" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠">
  </div>
  <div>
    <label for="new-target-price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
    <input type="number" id="new-target-price" class="w-full p-2 mb-3 rounded" placeholder="‡πÄ‡∏ä‡πà‡∏ô 3000">
  </div>
  <div>
    <label for="new-upload-image">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
    <input type="file" id="new-upload-image" accept="image/*" class="w-full mb-4">
  </div>
  <button class="confirm" onclick="addNewGoal()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
  <button class="cancel" onclick="hideAddGoalPopup()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
</div>

<div id="goal-details-popup" class="goal-details-popup">
  <h2 id="details-goal-name"></h2>
  <div class="progress-ring-large">
    <svg width="120" height="120">
      <circle cx="60" cy="60" r="50" stroke-width="8" fill="none"/>
      <circle id="details-progress-bar" cx="60" cy="60" r="50" stroke-width="8" fill="none" stroke-linecap="round" stroke-dasharray="314" stroke-dashoffset="314"/>
    </svg>
    <text id="details-progress-percent" x="60" y="65" text-anchor="middle" font-size="20"></text>
  </div>
  <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: <span id="details-target-price"></span> ‡∏ö‡∏≤‡∏ó</p>
  <p>‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß: <span id="details-saved-amount"></span> ‡∏ö‡∏≤‡∏ó</p>
  <a href="history.html">‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô</a>
  <button onclick="closeGoalDetailsPopup()">‡∏õ‡∏¥‡∏î</button>
</div>

    <script>
let goals = JSON.parse(localStorage.getItem('savingGoals')) || [];
const goalsListDiv = document.getElementById('goals-list');
const addGoalPopup = document.getElementById('add-goal-popup');
const goalDetailsPopup = document.getElementById('goal-details-popup');
const detailsGoalName = document.getElementById('details-goal-name');
const detailsProgressBar = document.getElementById('details-progress-bar');
const detailsProgressPercent = document.getElementById('details-progress-percent');
const detailsTargetPrice = document.getElementById('details-target-price');
const detailsSavedAmount = document.getElementById('details-saved-amount');

function showAddGoalPopup() {
    addGoalPopup.style.display = 'block';
}

function hideAddGoalPopup() {
    addGoalPopup.style.display = 'none';
    document.getElementById('new-target-name').value = '';
    document.getElementById('new-target-price').value = '';
    document.getElementById('new-upload-image').value = '';
}

function addNewGoal() {
    const name = document.getElementById('new-target-name').value;
    const price = parseFloat(document.getElementById('new-target-price').value);
    const imageFile = document.getElementById('new-upload-image').files[0];

    if (name && !isNaN(price) && imageFile) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const newGoal = {
                id: Date.now(),
                name: name,
                targetPrice: price,
                savedAmount: 0,
                imageUrl: e.target.result
            };
            goals.unshift(newGoal);
            localStorage.setItem('savingGoals', JSON.stringify(goals));
            renderGoals();
            hideAddGoalPopup();
        }
        reader.readAsDataURL(imageFile);
    } else if (name && !isNaN(price) && !imageFile) {
        const newGoal = {
            id: Date.now(),
            name: name,
            targetPrice: price,
            savedAmount: 0,
            imageUrl: 'https://via.placeholder.com/80'
        };
        goals.unshift(newGoal);
        localStorage.setItem('savingGoals', JSON.stringify(goals));
        renderGoals();
        hideAddGoalPopup();
    } else {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
    }
}

function renderGoals() {
    goalsListDiv.innerHTML = '';
    goals.forEach(goal => {
        const goalDiv = document.createElement('div');
        goalDiv.classList.add('goal-item');
        goalDiv.innerHTML = `
            <div class="goal-image-container">
                <img src="${goal.imageUrl}" alt="${goal.name}" class="goal-image">
            </div>
            <div class="goal-details">
                <h3 class="font-semibold text-lg text-purple-600">${goal.name}</h3>
                <p class="text-gray-700">‡∏£‡∏≤‡∏Ñ‡∏≤: ${goal.targetPrice.toLocaleString()} ‡∏ö‡∏≤‡∏ó</p>
                <p class="text-gray-700">‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏î‡πâ: <span id="saved-amount-${goal.id}">${goal.savedAmount.toLocaleString()}</span> ‡∏ö‡∏≤‡∏ó</p>
                <div class="goal-actions mt-2">
                    <button onclick="showGoalDetails(${goal.id})">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                    <button onclick="showAddSavingsPopup(${goal.id}, '${goal.name}')" class="bg-green-500 hover:bg-green-600">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô</button>
                    <button onclick="deleteGoal(${goal.id})" class="bg-red-500 hover:bg-red-600">‡∏•‡∏ö</button>
                </div>
            </div>
        `;
        goalsListDiv.appendChild(goalDiv);
    });
}


function calculatePercentage(saved, target) {
    const percent = target > 0 ? (saved / target) * 100 : 0;
    return percent > 100 ? 100 : percent.toFixed(1);
}

function showGoalDetails(goalId) {
    const goal = goals.find(g => g.id === goalId);
    if (goal) {
        detailsGoalName.innerText = goal.name;
        detailsTargetPrice.innerText = goal.targetPrice.toLocaleString();
        detailsSavedAmount.innerText = goal.savedAmount.toLocaleString();
        
        const percent = calculatePercentage(goal.savedAmount, goal.targetPrice);
        detailsProgressBar.style.strokeDashoffset = 314 - (314 * percent / 100);
        detailsProgressPercent.textContent = `${percent}%`;

        goalDetailsPopup.style.display = 'block';
    }
}

function closeGoalDetailsPopup() {
    goalDetailsPopup.style.display = 'none';
}


function closeGoalDetailsPopup() {
    goalDetailsPopup.style.display = 'none';
}

let currentGoalId = null;
let currentGoalName = '';

function showAddSavingsPopup(goalId, goalName) {
    currentGoalId = goalId;
    currentGoalName = goalName;

    const existingPopup = document.getElementById('add-savings-popup');
    if (existingPopup) {
        existingPopup.remove();
    }

    const popupDiv = document.createElement('div');
    popupDiv.id = 'add-savings-popup';
    popupDiv.classList.add('popup');
    popupDiv.innerHTML = `
        <h2 class="text-xl font-bold text-purple-600 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö "${goalName}"</h2>
        <div>
            <label for="add-amount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° (‡∏ö‡∏≤‡∏ó)</label>
            <input type="number" id="add-amount" class="mb-4 w-full p-2 rounded-lg border-2 border-purple-300 focus:ring-2 focus:ring-purple-400" placeholder="‡πÄ‡∏ä‡πà‡∏ô 100">
        </div>
        <button class="confirm" onclick="addSavingsToGoal()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
        <button class="cancel" onclick="closeAddSavingsPopup()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
    `;
    document.body.appendChild(popupDiv);
    popupDiv.style.display = 'block';
}

function closeAddSavingsPopup() {
    const popup = document.getElementById('add-savings-popup');
    if (popup) {
        popup.style.display = 'none';
    }
    currentGoalId = null;
    currentGoalName = '';
}

function addSavingsToGoal() {
    const amountToAdd = parseFloat(document.getElementById('add-amount').value);
    if (!isNaN(amountToAdd) && currentGoalId !== null) {
        let updatedGoal;
        goals = goals.map(goal => {
            if (goal.id === currentGoalId) {
                goal.savedAmount += amountToAdd;
                updatedGoal = goal; // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
            }
            return goal;
        });
        localStorage.setItem('savingGoals', JSON.stringify(goals));
        renderGoals();
        closeAddSavingsPopup();

        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏°‡πÄ‡∏á‡∏¥‡∏ô
        if (updatedGoal) {
            const now = new Date();
            const date = now.toLocaleDateString('th-TH');
            const time = now.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });
            const percent = calculatePercentage(updatedGoal.savedAmount, updatedGoal.targetPrice);

            const historyRecord = {
                date: date,
                time: time,
                goalName: updatedGoal.name,
                amount: amountToAdd,
                percent: percent,
                imageUrl: updatedGoal.imageUrl, // ‡πÄ‡∏û‡∏¥‡πà‡∏° URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                targetAmount: updatedGoal.targetPrice // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
            };

            let savingHistory = JSON.parse(localStorage.getItem('savingHistory')) || [];
            savingHistory.unshift(historyRecord); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤
            localStorage.setItem('savingHistory', JSON.stringify(savingHistory));
        }
    } else {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°');
    }
}

function calculatePercentage(saved, target) {
    const percent = target > 0 ? (saved / target) * 100 : 0;
    return percent > 100 ? 100 : percent.toFixed(1);
}

function deleteGoal(goalId) {
    if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        goals = goals.filter(goal => goal.id !== goalId);
        localStorage.setItem('savingGoals', JSON.stringify(goals));
        renderGoals();
    }
}

renderGoals();

    </script>

</body>
</html>
